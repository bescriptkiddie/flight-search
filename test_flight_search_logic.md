# 航班搜索逻辑测试用例

## 测试环境
- 浏览器：Chrome/Firefox/Safari
- 测试数据：使用备用示例数据（5条航班记录）

## 1. 基础功能测试

### 1.1 页面加载测试
**测试目的**：验证页面加载时数据初始化是否正确
**前置条件**：清除浏览器缓存
**测试步骤**：
1. 打开 index.html
2. 观察控制台输出
3. 检查页面元素加载状态

**预期结果**：
- [ ] 控制台显示"开始加载航班数据..."
- [ ] 显示"成功加载本地数据"
- [ ] 航班表格显示5条记录
- [ ] 筛选器下拉框正确填充

### 1.2 城市搜索功能测试

#### 1.2.1 城市下拉选择测试
**测试目的**：验证城市下拉选择功能
**测试步骤**：
1. 点击出发城市搜索框
2. 输入"北京"
3. 观察下拉列表
4. 使用键盘上下键选择
5. 按Enter确认选择

**预期结果**：
- [ ] 输入"北京"后显示匹配的城市
- [ ] 下拉列表最多显示10个城市
- [ ] 键盘导航正常工作
- [ ] 选择后搜索框正确填充

#### 1.2.2 模糊搜索测试
**测试目的**：验证城市模糊搜索功能
**测试步骤**：
1. 在出发城市输入"北"
2. 检查搜索结果
3. 清空后输入"上"
4. 检查搜索结果

**预期结果**：
- [ ] 显示所有包含"北"的城市
- [ ] 显示所有包含"上"的城市
- [ ] 搜索结果按相关性排序

#### 1.2.3 城市搜索筛选测试
**测试用例**：
| 出发城市 | 目的地城市 | 预期结果 |
|---------|-----------|----------|
| 北京 | 上海 | 显示北京→上海的航班 |
| 空 | 广州 | 显示所有到广州的航班 |
| 深圳 | 空 | 显示所有从深圳出发的航班 |
| 北京 | 东京 | 显示无结果提示 |

### 1.3 行程类型切换测试

#### 1.3.1 单程模式测试
**测试步骤**：
1. 设置出发城市：北京
2. 设置目的地城市：上海
3. 点击"单程"按钮
4. 观察筛选结果

**预期结果**：
- [ ] 只显示北京→上海的单程航班
- [ ] 不显示返程航班
- [ ] 不显示"去程"/"返程"标记

#### 1.3.2 往返模式测试
**测试步骤**：
1. 设置出发城市：北京
2. 设置目的地城市：上海
3. 点击"往返"按钮
4. 观察筛选结果

**预期结果**：
- [ ] 显示北京→上海的"去程"航班
- [ ] 显示上海→北京的"返程"航班
- [ ] 正确标记"去程"/"返程"
- [ ] 往返航班数量匹配

#### 1.3.3 行程类型切换测试
**测试步骤**：
1. 设置城市搜索条件
2. 切换到往返模式
3. 切换到单程模式
4. 重复切换多次

**预期结果**：
- [ ] 切换时保留城市搜索条件
- [ ] 不丢失已选择的筛选条件
- [ ] 数据不重复或丢失

## 2. 筛选条件组合测试

### 2.1 时间段筛选测试
**测试用例**：
| 时间段 | 预期结果 |
|--------|----------|
| 凌晨(00:00-06:00) | 显示出发时间在凌晨的航班 |
| 上午(06:00-12:00) | 显示出发时间在上午的航班 |
| 下午(12:00-18:00) | 显示出发时间在下午的航班 |
| 晚上(18:00-24:00) | 显示出发时间在晚上的航班 |

### 2.2 2666可用筛选测试
**测试步骤**：
1. 点击"2666可用"按钮
2. 观察筛选结果
3. 再次点击取消筛选
4. 观察结果恢复

**预期结果**：
- [ ] 只显示产品类型包含"2666"的航班
- [ ] 取消筛选后显示所有航班
- [ ] 按钮状态正确切换

### 2.3 航段筛选测试
**测试步骤**：
1. 选择不同航段数(1/2/3/4+)
2. 观察筛选结果
3. 切换回"全部航段"

**预期结果**：
- [ ] 正确按航段数筛选航班
- [ ] 支持航段数据时有效

### 2.4 多条件组合测试
**测试用例**：
| 条件组合 | 预期结果 |
|---------|----------|
| 北京→上海 + 晚上 + 2666可用 | 显示同时满足所有条件的航班 |
| 广州→深圳 + 红眼航班 | 显示夜间航班 |
| 往返 + 周一运营 | 显示周一有往返的航班 |

## 3. 边界情况测试

### 3.1 空数据测试
**测试步骤**：
1. 设置不存在的城市组合
2. 设置不存在的航班号
3. 设置冲突的时间段

**预期结果**：
- [ ] 显示"未找到相关航班"提示
- [ ] 提示信息友好且准确
- [ ] 可以方便地修改搜索条件

### 3.2 大数据量测试
**测试步骤**：
1. 清除所有筛选条件
2. 观察加载性能
3. 快速切换筛选条件

**预期结果**：
- [ ] 页面响应流畅
- [ ] 筛选操作无明显延迟
- [ ] 内存使用合理

### 3.3 快速操作测试
**测试步骤**：
1. 快速输入城市名称
2. 快速切换行程类型
3. 快速点击多个筛选按钮

**预期结果**：
- [ ] 不出现界面卡顿
- [ ] 不丢失用户输入
- [ ] 最终状态正确

## 4. 错误处理测试

### 4.1 数据加载失败测试
**测试步骤**：
1. 模拟网络错误（断开网络）
2. 刷新页面
3. 观察错误处理

**预期结果**：
- [ ] 显示备用示例数据
- [ ] 显示错误提示信息
- [ ] 提供重试选项

### 4.2 异常输入测试
**测试步骤**：
1. 输入特殊字符到搜索框
2. 输入超长文本
3. 输入SQL注入语句

**预期结果**：
- [ ] 程序不崩溃
- [ ]  gracefully处理异常输入
- [ ] 显示适当的错误信息

## 5. 用户界面测试

### 5.1 响应式设计测试
**测试设备**：桌面、平板、手机
**测试内容**：
- [ ] 界面元素正确显示
- [ ] 搜索框和下拉菜单可操作
- [ ] 表格可以横向滚动
- [ ] 按钮大小适合触摸操作

### 5.2 键盘导航测试
**测试步骤**：
1. 使用Tab键导航
2. 使用Enter键选择
3. 使用Escape键取消

**预期结果**：
- [ ] Tab键顺序合理
- [ ] Enter键功能正常
- [ ] Escape键可以取消操作

### 5.3 视觉反馈测试
**测试内容**：
- [ ] 加载状态显示正确
- [ ] 筛选状态指示器更新
- [ ] 鼠标悬停效果正常
- [ ] 选中状态清晰可见

## 6. 性能测试

### 6.1 初始加载性能
**测试指标**：
- [ ] 页面加载时间 < 3秒
- [ ] 首次内容绘制 < 1.5秒
- [ ] 可交互时间 < 2秒

### 6.2 筛选响应性能
**测试指标**：
- [ ] 筛选操作响应 < 500ms
- [ ] 城市搜索响应 < 300ms
- [ ] 行程类型切换 < 200ms

### 6.3 内存使用测试
**测试步骤**：
1. 打开性能监视器
2. 进行各种操作
3. 观察内存变化

**预期结果**：
- [ ] 内存使用稳定
- [ ] 无内存泄漏
- [ ] 垃圾回收正常

## 7. 兼容性测试

### 7.1 浏览器兼容性
**测试浏览器**：
- Chrome (最新版)
- Firefox (最新版)
- Safari (最新版)
- Edge (最新版)

**测试内容**：
- [ ] 所有功能正常工作
- [ ] 样式正确显示
- [ ] 控制台无错误

### 7.2 设备兼容性
**测试设备**：
- Windows桌面
- Mac桌面
- iPhone手机
- Android手机
- iPad平板

## 8. 安全性测试

### 8.1 XSS攻击防护
**测试输入**：
```javascript
<script>alert('XSS')</script>
<img src="x" onerror="alert('XSS')">
```

**预期结果**：
- [ ] 输入被正确转义
- [ ] 脚本不会执行
- [ ] 页面保持正常

### 8.2 数据验证
**测试内容**：
- [ ] 输入验证充分
- [ ] 数据类型检查
- [ ] 长度限制合理

## 测试记录表格

| 测试项 | 测试日期 | 测试人 | 结果 | 备注 |
|--------|----------|--------|------|------|
| 页面加载 | 待填写 | 待填写 | 待填写 | 待填写 |
| 城市搜索 | 待填写 | 待填写 | 待填写 | 待填写 |
| 行程类型切换 | 待填写 | 待填写 | 待填写 | 待填写 |
| 多条件组合 | 待填写 | 待填写 | 待填写 | 待填写 |
| 边界情况 | 待填写 | 待填写 | 待填写 | 待填写 |
| 性能测试 | 待填写 | 待填写 | 待填写 | 待填写 |

## 自动化测试脚本

### 基本测试函数
```javascript
// 测试辅助函数
function runTest(testName, testFunction) {
  console.log(`\n=== 开始测试: ${testName} ===`);
  try {
    const result = testFunction();
    console.log(`✅ ${testName}: ${result ? '通过' : '失败'}`);
    return result;
  } catch (error) {
    console.error(`❌ ${testName}: 错误 - ${error.message}`);
    return false;
  }
}

// 城市搜索测试
function testCitySearch() {
  const departureInput = document.getElementById('departureSearch');
  const destinationInput = document.getElementById('destinationSearch');

  // 测试1: 输入城市名称
  departureInput.value = '北京';
  departureInput.dispatchEvent(new Event('input'));

  // 等待筛选完成
  setTimeout(() => {
    const results = document.querySelectorAll('#flightTableBody tr');
    const hasBeijingFlights = Array.from(results).some(row =>
      row.textContent.includes('北京')
    );

    console.log(`北京出发航班: ${results.length} 个`);
    return results.length > 0;
  }, 500);
}

// 执行测试
runTest('城市搜索功能', testCitySearch);
```